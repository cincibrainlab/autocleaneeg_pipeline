---
title: Wavelet Thresholding
description: Remove transient noise using wavelet-based denoising.
---

# Wavelet Thresholding

Wavelet thresholding attenuates short, high-amplitude artifacts by decomposing each EEG channel into wavelet coefficients and shrinking the noisy components. This mirrors the approach used in the HAPPE MATLAB pipeline.

<Steps>
<Step title="Run the function">
```python
from autoclean import wavelet_threshold
cleaned = wavelet_threshold(raw)
```
</Step>
<Step title="Verify the effect">
1. Plot a channel before and after to see artifact reduction.
2. Inspect summary statistics like peak-to-peak amplitude.
</Step>
<Step title="Concern: Over-smoothing">
<Note>
Excessive thresholding can remove neural signal. Adjust the `level` or `wavelet` if you notice over-smoothing.
</Note>
</Step>
</Steps>

## Testing

To test the implementation yourself:

```bash
pytest tests/functions/test_preprocessing.py::TestWaveletThreshold::test_wavelet_threshold_basic
```

This unit test injects a large transient into synthetic data and confirms the function reduces its amplitude.

## PDF Reporting

Use the helper script to create a PDF comparison of pre/post wavelet cleaning:

```bash
python scripts/wavelet_report.py /path/to/TD1v2_ica_raw.set \
  --output reports/TD1v2_wavelet_report.pdf \
  --metrics-csv reports/TD1v2_wavelet_metrics.csv
```

The report includes summary statistics, a top-channel waveform overlay, and a leaderboard of channels ranked by peak-to-peak reduction. Adjust `--wavelet`, `--level`, or `--picks all` to explore different configurations.

<Diagram name="Thresholding flow">
raw signal -> wavelet transform -> soft thresholding -> reconstructed signal
</Diagram>
